## Use the R_HOME indirection to support installations of multiple R version
PKG_LIBS = `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"` @OPENCL_LIB@

CXX_STD = CXX11

PKG_CPPFLAGS = -I. -Icyclops -DR_BUILD -DDOUBLE_PRECISION @HAVE_OPENCL@
PKG_CXXFLAGS = -s

OBJECTS.cyclops = \
    cyclops/CcdInterface.o \
    cyclops/CompressedDataMatrix.o \
    cyclops/CyclicCoordinateDescent.o \
    cyclops/ModelData.o \
    cyclops/SqlModelData.o \
    cyclops/Timer.o

OBJECTS.drivers = \
    cyclops/drivers/AbstractCrossValidationDriver.o \
    cyclops/drivers/AbstractDriver.o \
    cyclops/drivers/AbstractSelector.o \
    cyclops/drivers/AutoSearchCrossValidationDriver.o \
    cyclops/drivers/BootstrapDriver.o \
    cyclops/drivers/BootstrapSelector.o \
    cyclops/drivers/CrossValidationSelector.o \
    cyclops/drivers/GridSearchCrossValidationDriver.o \
    cyclops/drivers/HierarchyAutoSearchCrossValidationDriver.o \
    cyclops/drivers/HierarchyGridSearchCrossValidationDriver.o \
    cyclops/drivers/ProportionSelector.o

OBJECTS.priors = \
    cyclops/priors/CovariatePrior.o

OBJECTS.io = \
    cyclops/io/InputReader.o

OBJECTS.engine = \
    cyclops/engine/AbstractModelSpecifics.o

OBJECTS.utils = \
    utils/HParSearch.o

OBJECTS.thread = \
    tinythread/tinythread.o

OBJECTS.R = \
    IsSorted.o \
    RcppExports.o \
    RcppModelData.o \
    RcppCyclopsInterface.o \
    RcppGpuInterface.o \
    RcppIsSorted.o

OBJECTS = $(OBJECTS.cyclops) $(OBJECTS.drivers) \
          $(OBJECTS.engine) $(OBJECTS.utils) \
          $(OBJECTS.threads) $(OBJECTS.R) \
          $(OBJECTS.priors) $(OBJECTS.io)

all : $(SHLIB)
          
cyclops/engine/AbstractModelSpecifics.o : cyclops/engine/ModelSpecifics.h cyclops/engine/ModelSpecifics.hpp cyclops/engine/GPUModelSpecifics.hpp

%.h :

%.hpp :


